-- Dataform table definition for D_PATRON
-- Source: Sybase
-- Domain: Customer & Loyalty Management
-- Dataset: crown_customer_loyalty

config {
  type: "table",
  schema: "crown_customer_loyalty",
  description: "Migrated from Sybase - Customer & Loyalty Management",
  bigquery: {,
    partitionBy: "BegEffDt",
    clusterBy: ["PATRONID"],
  }
}

SELECT
  PATRONID STRING NOT NULL,
  GeographicID STRING NOT NULL,
  GeoDemographicID STRING NOT NULL,
  MbrshpID STRING NOT NULL,
  ETLJobDtlID STRING NOT NULL,
  SignUpSiteID STRING NOT NULL,
  HomeSiteID STRING NOT NULL,
  SctyCde STRING,
  PatronNumber STRING NOT NULL,
  PatronNumberChar STRING NOT NULL,
  Mel_LegacyPatronNum STRING,
  Mel_LegacyPatronNumChar STRING,
  Per_LegacyPatronNum STRING,
  Per_LegacyPatronNumChar STRING,
  BegEffDt STRING NOT NULL,
  EndEffDt STRING,
  CurrRowFlg STRING NOT NULL,
  ActiveFlg STRING,
  PatronSecLvl STRING,
  Title STRING,
  PatronName STRING,
  FirstName STRING,
  MiddleName STRING,
  LastName STRING NOT NULL,
  Suffix STRING,
  Initials STRING,
  Pref_Title STRING,
  Pref_Name STRING,
  Pref_FirstName STRING,
  Pref_MiddleName STRING,
  Pref_LastName STRING,
  Pref_Suffix STRING,
  PrefNameFlg STRING,
  DOB STRING,
  DOB_Yr STRING,
  DOB_Mon STRING,
  DOB_Day STRING,
  GenderCde STRING,
  Spouse STRING,
  OccupationCde STRING,
  Occupation STRING,
  Res_StreetLine1 STRING,
  Res_StreetLine2 STRING,
  Res_Suburb STRING,
  Res_StateCde STRING,
  Res_State STRING,
  Res_CountryCde STRING,
  Res_Country STRING,
  Res_PostCde STRING,
  Post_StreetLine1 STRING,
  Post_StreetLine2 STRING,
  Post_Suburb STRING,
  Post_StateCde STRING,
  Post_State STRING,
  Post_CountryCde STRING,
  Post_Country STRING,
  Post_PostCde STRING,
  DT_StreetAddr STRING,
  DT_Suburb STRING,
  DT_PostCde STRING,
  DT_SortPlan STRING,
  DT_StateCde STRING,
  DT_MailBarCde STRING,
  DPID STRING,
  DPID_MatchCmt STRING,
  LongDegrees STRING,
  LatDegrees STRING,
  DistanceFrCasino STRING,
  HomePhone STRING,
  WorkPhone STRING,
  AltPhone STRING,
  Fax STRING,
  MobilePhone STRING,
  SMSFlg STRING,
  InvalidSMSFlg STRING,
  EmailAddr STRING,
  EmailFlg STRING,
  InvalidEmailFlg STRING,
  MailToCde STRING,
  MailTo STRING,
  MailStsCde STRING,
  MailSts STRING,
  Ethnicity STRING,
  PrefContactLangCde STRING,
  PrefContactLang STRING,
  CommPref STRING,
  Prom_Material_Ind STRING,
  GM_Material_Mail_Flg STRING,
  Undesirable_Wanted_Ind STRING,
  ID_Type STRING,
  ID_Num STRING,
  ID_ExpiryDt STRING,
  ID_IssuStateCde STRING,
  ID_IssuState STRING,
  ID_IssuCountryCde STRING,
  ID_IssuCountry STRING,
  ID_PntsFlg STRING,
  SourceCde STRING,
  SignUpChannel STRING,
  SignUpPtyLocNum STRING,
  SignUpPty STRING,
  HomePtyLocNum STRING,
  HomePty STRING,
  ClubJoinDT STRING NOT NULL,
  ClubJoinedTmofDy STRING,
  SignupCls STRING,
  Mel_MbrCls STRING,
  Per_MbrCls STRING,
  MbrClsGrp STRING,
  ClubType STRING,
  AccntCreationEmpID STRING,
  ReferredEmpID STRING,
  PlyrRefer STRING,
  YourPlayFlg STRING,
  MbrHubAccess STRING,
  CrownBetAccnt STRING,
  ClubPinFlg STRING,
  UnifiedFlg STRING,
  UnifiedDt STRING,
  UnifiedDtTm STRING,
  MigratedFlg STRING,
  BusOwnerCde STRING,
  BusOwner STRING,
  PntsBalBand STRING,
  PriPatronCardFlg STRING,
  NumAncillaryCards STRING,
  JnktOperFlg STRING,
  PASOpt STRING,
  PASDelMethod STRING,
  PASSignedUpDt STRING,
  PASViewedDt STRING,
  PASClctdDt STRING,
  NetworkName STRING,
  NetworkDesc STRING,
  NetworkMbrTyp STRING,
  CrownLtdID STRING,
  CrownLtdName STRING,
  AddrRgn STRING,
  Country_Metro_Name STRING,
  AddrLocTyp STRING,
  Rgn STRING,
  VIC_Country_Metro_Ind STRING,
  LGA_Num STRING,
  LGA_Name STRING,
  LGA_Type STRING,
  LGA_TypeDesc STRING,
  T200Flg STRING,
  MRMbrFlg STRING,
  CmpDrnksAllwdFlg STRING,
  BasmntCarParkFlg STRING,
  BasmntCarParkFlgAuthEmpID STRING,
  BasmntCarParkFlgUpdDttm STRING,
  ClubLockoutFlg STRING,
  ClubLockoutLst STRING,
  ClubLockoutRsn STRING,
  PrivLockoutFlg STRING,
  PrivLockoutLst STRING,
  Mel_StopCodes STRING,
  Per_StopCodes STRING,
  Mel_DailyTmLmtAmt STRING,
  Mel_DailyNetLossLmtAmt STRING,
  Mel_AnnlNetLossLmtAmt STRING,
  Per_DailyTmLmtAmt STRING,
  Per_DailyNetLossLmtAmt STRING,
  Per_AnnlNetLossLmtAmt STRING,
  Mel_PersHostEmpID STRING,
  Mel_PersHostEmpFirstName STRING,
  Mel_PersHostEmpLastName STRING,
  Per_PersHostEmpID STRING,
  Per_PersHostEmpFirstName STRING,
  Per_PersHostEmpLastName STRING,
  MbrshpTyp STRING,
  MbrshpSubTyp STRING,
  MbrshpLvl STRING,
  VIP_ClubLvl STRING,
  VIP_ClubTagNum STRING,
  PriPrivCardName STRING,
  ScdryPrivCardName STRING,
  MEL_PatronSegID STRING,
  PER_PatronSegID STRING,
  ClubLockoutSrc STRING,
  PrivLockoutSrc STRING,
  GeographicID_P STRING NOT NULL,
  Addr_Valid_Sts_R STRING,
  Addr_Valid_Sts_P STRING,
  DPID_P STRING,
  DPID_MatchCmt_P STRING,
  DT_StreetAddr_P STRING,
  DT_Suburb_P STRING,
  DT_PostCde_P STRING,
  DT_SortPlan_P STRING,
  DT_StateCde_P STRING,
  DT_MailBarCde_P STRING,
  LongDegrees_P STRING,
  LatDegrees_P STRING,
  DistanceFrCasino_P STRING,
  LGA_Num_P STRING,
  LGA_Name_P STRING,
  LGA_Type_P STRING,
  LGA_TypeDesc_P STRING,
  Email_Typ STRING,
  Email_Valid_Sts STRING,
  Email_Sts_Cde STRING,
  Email_Sts_Des STRING,
  Email_Dom STRING,
  Email_Conn STRING,
  Email_Disp STRING,
  Email_Role_Addr STRING,
  Phone_Valid_Sts_M STRING,
  Phone_Sts_Cde_M STRING,
  Phone_Sts_Des_M STRING,
  Phone_Resp_M STRING,
  Phone_Valid_Sts_H STRING,
  Phone_Sts_Cde_H STRING,
  Phone_Sts_Des_H STRING,
  Phone_Resp_H STRING,
  Phone_Valid_Sts_W STRING,
  Phone_Sts_Cde_W STRING,
  Phone_Sts_Des_W STRING,
  Phone_Resp_W STRING,
  Phone_Valid_Sts_O STRING,
  Phone_Sts_Cde_O STRING,
  Phone_Sts_Des_O STRING,
  Phone_Resp_O STRING,
  SingleNameInd STRING,
  CustSts STRING,
  MelAdminSts STRING,
  PerAdminSts STRING,
  DABInitiatedFlg STRING,
  LoyaltyProgram STRING,
  PriPatronNum STRING,
  ScdryAccntRsn STRING,
  MarketingSiteID STRING,
  MarketingPtyLocNum STRING,
  MarketingPty STRING,
  PhoneFlg STRING,
  GFACAckSts STRING,
  CoolingOffSts STRING,
  CoolingOffStartDtTm TIMESTAMP,
  CoolingOffEndDtTm TIMESTAMP,
  Syd_StopCodes STRING,
  Syd_AdminSts STRING,
  Syd_DailyTmLmtAmt INT64,
  Syd_DailyNetLossLmtAmt NUMERIC,
  Syd_HighPrtyCmt STRING,
  Syd_PatronSegID INT64,
  HostEmpID STRING,
  HostEmpFirstName STRING,
  HostEmpLastName STRING,
  HostEmpSiteID STRING,
  HostEmpPtyLocNum INT64,
  HostEmpPty STRING,
  EGMLoyaltyOptInFlg STRING
FROM `${ref('sybase_source')}`
